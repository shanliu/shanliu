<!DOCTYPE HTML>
<html lang="zh-CN" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>汇编常用指令 - shanliu blog</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../rust/SUMMARY.html"><strong aria-hidden="true">1.</strong> RUST笔记</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../rust/base.html"><strong aria-hidden="true">1.1.</strong> 一些概念</a></li><li class="chapter-item expanded "><a href="../rust/trait.html"><strong aria-hidden="true">1.2.</strong> Trait</a></li><li class="chapter-item expanded "><a href="../rust/mod.html"><strong aria-hidden="true">1.3.</strong> mod</a></li><li class="chapter-item expanded "><a href="../rust/async.html"><strong aria-hidden="true">1.4.</strong> async</a></li><li class="chapter-item expanded "><a href="../rust/enum.html"><strong aria-hidden="true">1.5.</strong> enum</a></li><li class="chapter-item expanded "><a href="../rust/collections.html"><strong aria-hidden="true">1.6.</strong> collections</a></li><li class="chapter-item expanded "><a href="../rust/variable.html"><strong aria-hidden="true">1.7.</strong> variable</a></li><li class="chapter-item expanded "><a href="../rust/string-less-than-greater-than-number.html"><strong aria-hidden="true">1.8.</strong> string&lt;-&gt;number</a></li><li class="chapter-item expanded "><a href="../rust/ownership.html"><strong aria-hidden="true">1.9.</strong> ownership</a></li><li class="chapter-item expanded "><a href="../rust/lifetime.html"><strong aria-hidden="true">1.10.</strong> lifetime</a></li><li class="chapter-item expanded "><a href="../rust/string.html"><strong aria-hidden="true">1.11.</strong> string</a></li><li class="chapter-item expanded "><a href="../rust/c-greater-than-rust.html"><strong aria-hidden="true">1.12.</strong> c&lt;-&gt;rust</a></li><li class="chapter-item expanded "><a href="../rust/creat.html"><strong aria-hidden="true">1.13.</strong> creat</a></li><li class="chapter-item expanded "><a href="../rust/macro.html"><strong aria-hidden="true">1.14.</strong> macro_rules</a></li><li class="chapter-item expanded "><a href="../rust/proc-macro.html"><strong aria-hidden="true">1.15.</strong> proc-macro</a></li></ol></li><li class="chapter-item expanded "><a href="../cpp/SUMMARY.html"><strong aria-hidden="true">2.</strong> C&amp;CPP笔记</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../cpp/syntax.html"><strong aria-hidden="true">2.1.</strong> 语法</a></li><li class="chapter-item expanded "><a href="../cpp/debug.html"><strong aria-hidden="true">2.2.</strong> 调试与错误</a></li><li class="chapter-item expanded "><a href="../cpp/stdarg.h.html"><strong aria-hidden="true">2.3.</strong> 不定参数</a></li><li class="chapter-item expanded "><a href="../cpp/za-xiang.html"><strong aria-hidden="true">2.4.</strong> 杂项</a></li><li class="chapter-item expanded "><a href="../cpp/zi-fu-chuan.html"><strong aria-hidden="true">2.5.</strong> 字符串</a></li><li class="chapter-item expanded "><a href="../cpp/socket.html"><strong aria-hidden="true">2.6.</strong> 网络</a></li><li class="chapter-item expanded "><a href="../cpp/wen-jian.html"><strong aria-hidden="true">2.7.</strong> 文件</a></li><li class="chapter-item expanded "><a href="../cpp/jin-cheng.html"><strong aria-hidden="true">2.8.</strong> 进程</a></li><li class="chapter-item expanded "><a href="../cpp/pthread.html"><strong aria-hidden="true">2.9.</strong> 线程</a></li><li class="chapter-item expanded "><a href="../cpp/xin-hao.html"><strong aria-hidden="true">2.10.</strong> 信号</a></li><li class="chapter-item expanded "><a href="../cpp/guan-dao.html"><strong aria-hidden="true">2.11.</strong> 管道</a></li><li class="chapter-item expanded "><a href="../cpp/shi-jian.html"><strong aria-hidden="true">2.12.</strong> 时间</a></li><li class="chapter-item expanded "><a href="../cpp/dong-tai-jia-zai-ku.html"><strong aria-hidden="true">2.13.</strong> 动态加载库</a></li><li class="chapter-item expanded "><a href="../cpp/chang-yong-suan-fa.html"><strong aria-hidden="true">2.14.</strong> 常用算法</a></li><li class="chapter-item expanded "><a href="../cpp/gcchun-bian-hui-bian.html"><strong aria-hidden="true">2.15.</strong> C调用汇编</a></li><li class="chapter-item expanded "><a href="../cpp/hui-bian-ji-cun-qi.html"><strong aria-hidden="true">2.16.</strong> 汇编寄存器</a></li><li class="chapter-item expanded "><a href="../cpp/hui-bian-chang-yong-zhi-ling.html" class="active"><strong aria-hidden="true">2.17.</strong> 汇编常用指令</a></li><li class="chapter-item expanded "><a href="../cpp/jin-cheng-du-xie-wen-jian-suo.html"><strong aria-hidden="true">2.18.</strong> 进程读写文件锁</a></li><li class="chapter-item expanded "><a href="../cpp/phpzhong-jiyu-atomic-de-zi-xuan-suo-shi-xian.html"><strong aria-hidden="true">2.19.</strong> PHP中基于atomic的自旋锁实现</a></li><li class="chapter-item expanded "><a href="../cpp/chang-liang-zi-fu-chuan-pi-liang-ying-she.html"><strong aria-hidden="true">2.20.</strong> PHP中常量字符串批量映射</a></li><li class="chapter-item expanded "><a href="../cpp/tcpudpxie-yi-xiang-jie.html"><strong aria-hidden="true">2.21.</strong> TCP/UDP包示例</a></li><li class="chapter-item expanded "><a href="../cpp/xi-tong-diao-yong-zhong-ding-yi.html"><strong aria-hidden="true">2.22.</strong> 系统函数重定义</a></li><li class="chapter-item expanded "><a href="../cpp/bit-op.html"><strong aria-hidden="true">2.23.</strong> 加减乘除位运算</a></li></ol></li><li class="chapter-item expanded "><a href="../other/SUMMARY.html"><strong aria-hidden="true">3.</strong> JS和其他笔记</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../other/react-native.html"><strong aria-hidden="true">3.1.</strong> react-native</a></li><li class="chapter-item expanded "><a href="../other/rxjs.html"><strong aria-hidden="true">3.2.</strong> rxjs</a></li><li class="chapter-item expanded "><a href="../other/vim.html"><strong aria-hidden="true">3.3.</strong> vim</a></li><li class="chapter-item expanded "><a href="../other/css-flex.html"><strong aria-hidden="true">3.4.</strong> css flex</a></li><li class="chapter-item expanded "><a href="../other/docker.html"><strong aria-hidden="true">3.5.</strong> docker</a></li><li class="chapter-item expanded "><a href="../other/es6.html"><strong aria-hidden="true">3.6.</strong> es6</a></li><li class="chapter-item expanded "><a href="../other/react.html"><strong aria-hidden="true">3.7.</strong> react</a></li></ol></li><li class="chapter-item expanded "><a href="../php/SUMMARY.html"><strong aria-hidden="true">4.</strong> PHP笔记</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../php/composer.html"><strong aria-hidden="true">4.1.</strong> composer</a></li><li class="chapter-item expanded "><a href="../php/ext.html"><strong aria-hidden="true">4.2.</strong> 扩展开发</a></li><li class="chapter-item expanded "><a href="../php/php7-feature.html"><strong aria-hidden="true">4.3.</strong> php7一些特性</a></li><li class="chapter-item expanded "><a href="../php/sort.html"><strong aria-hidden="true">4.4.</strong> php快速排序</a></li><li class="chapter-item expanded "><a href="../php/larvale.html"><strong aria-hidden="true">4.5.</strong> larvale</a></li><li class="chapter-item expanded "><a href="../php/re2candbison.html"><strong aria-hidden="true">4.6.</strong> re2c&amp;bison</a></li><li class="chapter-item expanded "><a href="../php/rabbitmq.html"><strong aria-hidden="true">4.7.</strong> rabbitmq</a></li><li class="chapter-item expanded "><a href="../php/proto.html"><strong aria-hidden="true">4.8.</strong> proto</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">shanliu blog</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/shanliu/blog" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="汇编常用指令"><a class="header" href="#汇编常用指令">汇编常用指令</a></h1>
<blockquote>
<p>AT&amp;T 与 INTEL 注意差异</p>
</blockquote>
<ol>
<li>INTEL mov eax,1 ;1 十进制 mov eax,01H ;1H 十六进制 a:mov eax,offset a;得到位置 mov rbp[-12],1</li>
<li>AT&amp;T: mov $1,%eax ;10进制 mov $0x1,%eax ;十六进制 a:mov $ab,%eax ;a标签可重复,ab 为得到之前位置 af 为之后位置 mov $1,-12(%rbp)</li>
</ol>
<blockquote>
<p>add 加</p>
</blockquote>
<pre><code>assume cs:code
code segment
    start:
        mov ax,10
        mov dx,1
        add ax,dx
        ; ax=11
code ends
end start
</code></pre>
<blockquote>
<p>sub 减</p>
</blockquote>
<pre><code>assume cs:code
code segment
    start:
        mov ax,10
        mov dx,1
        sub ax,dx
        ; ax=9
code ends
end start
</code></pre>
<blockquote>
<p>mul 乘 8_8 乘数:AL 结果:AX 16_16 乘数:Ax 结果:高AX 低DX</p>
</blockquote>
<pre><code>assume cs:CODES
CODES SEGMENT
START:
    ;8 位
    mov al,2
    mov bl,2
    mul dl
    ;结果 AX 4
    ;16 位
    mov ax,1000
    mov dx,1000
    mul dx
    ;结果 高AX E512 低DX 00C1
CODES ENDS
    END START
</code></pre>
<blockquote>
<p>div 除 除数:8(寄存器或内存) 被除:16 (AX) 结果：商(AL) 余数(AH) 除数:16(寄存器或内存) 被除:32 高16(DX) 低16(AX) 结果：商(AX) 余数(DX)</p>
</blockquote>
<pre><code>assume cs:code
code segment
    start:
        ; 16位除法 10/3
        mov ax,10
        mov dl,3
        div dl
        ; ah 余数 al 商
        ;32位除法 8800502 (86 48F6) / 6565 (19A5)
        mov dx,86H ;高16
        mov ax,48F6H ;低16
        mov bx,19A5H
        div bx
        ; 商(AX)053C 余数(DX) 0D4A
code ends
end start
</code></pre>
<blockquote>
<p>adc 进位加</p>
</blockquote>
<pre><code>// dome1: add ax,bx 结果 ax
// 等于如下　adc = ah+bh+CF位
add al,bl
adc ah,bh
// dome2: =&gt;1ef000h+201000h 结果　高位ax　低位dx
mov ax,001eh
mov dx,0f000h
add dx,1000h
adc ax,0020h
</code></pre>
<blockquote>
<p>sbb 借位减法</p>
</blockquote>
<pre><code>assume cs:CODES
CODES SEGMENT
START:
    ;20001H-10002H
    ;高 16 位AX 低16 dx
    mov ax,02H
    mov dx,1
    sub dx,2
    sbb ax,1 ; 借位 AX=AX-1-CF
    ;结果 高16 AX 0000 低16 DX FFFF
CODES ENDS
    END START
</code></pre>
<blockquote>
<p>jmp 跳转</p>
</blockquote>
<pre><code>assume cs:code
code segment
    start:
        mov cx,3
        jmp jmp1
        ;...
    jmp1:
        mov ax,1
        mov cx,1
        ;...
code ends
end start
</code></pre>
<blockquote>
<p>movsb movsw movsd 内存转移</p>
</blockquote>
<pre><code>assume cs:CODES
data segment
    dw 8 dup(0)
    db 16 dup(1)
data ends;
CODES SEGMENT
START:
    mov bx,data
    mov ds,bx
    add bx,1
    mov es,bx
    mov si,0
    mov di,0
    ;rep循环
    mov cx,16
    cld
    rep movsb
    ;上面3行等价于
    ;mov cx,16
    ;cploop:
    ;mov dl,ds:[si]
    ;mov es:[di],dl
    ;inc si
    ;inc di
    ;loop cploop
CODES ENDS
    END START
</code></pre>
<blockquote>
<p>offset 得到位置</p>
</blockquote>
<pre><code>assume cs:code
code segment
    start:
        mov bx,offset exit1
        ;lea bx,exit1 ;等价上面
        ;exit1 位置赋值到bx中
    exit1:
        mov ax,0
code ends
end start
</code></pre>
<blockquote>
<p>int 中断自定义 X86默认0000:0 -0000:03FF 为中断处理地址存储 中断地址保存规则 IP = N_4 CS = N_4+2 (N为中断号 例如INT 80H)</p>
</blockquote>
<pre><code>assume cs:CODES
CODES SEGMENT
START:

    CALL copy_new_7CH
    CALL set_new_7CH

    INT 7CH

    ;...
;===============================================
new_7CH:        MOV AX,1000H
; 自定义处理指令
                IRET
end_new_7CH:    
;===============================================
set_new_7CH:        MOV BX,0
                    MOV ES,BX
                    MOV word ptr ES:[7CH*4],7E00H
                    MOV word ptr ES:[7CH*4+2],0
end_set_new_7CH:     RET
;===============================================
copy_new_7CH:        MOV AX,0
                    MOV ES,AX
                    MOV DI,7E00H

                    MOV AX,CS
                    MOV DS,AX
                    MOV SI,OFFSET new_7CH

                    mov cx,OFFSET end_new_7CH - new_7CH
                    cld
                    rep movsb
end_copy_new_7CH:    ret
;===============================================
CODES ENDS
    END START
</code></pre>
<blockquote>
<p>call ret 函数调用 一定要做到栈平衡</p>
</blockquote>
<pre><code>assume cs:code
code segment
    start:
        mov ax,1
        mov bx,2
        sub ax,ax
        call fun1
        mov cx,10
        int 16H
    fun1:; 会push IP寄存器到栈中,在ret时候返回用,linux实现进程切换就靠这个.
        push bp
        mov bp,sp
        sub sp,016h ;这里偏移sp地址,等于为函数内变量申请内存,即局部变量
        call fun2
        ;...
        mov sp,bp ;还原sp到原位置 实现栈平衡
        pop bp
        ;假如这里push 地址,下面ret后会返回到这里push的地址中
        ret;会pop 栈数据到IP寄存器后执行
    fun2:
        push bp
        mov bp,sp
        mov ax,3
        mov bx,4
        pop bp
        ret
code ends
end start
</code></pre>
<blockquote>
<p>rdtsc CPU时间 一条读取TSC的指令，它把TSC的低32位存放在eax寄存器中，把TSC的高32位存放在edx中 (TSC指令获取CPU时间)</p>
</blockquote>
<pre><code>rdtsc
</code></pre>
<blockquote>
<p>bt bts btr btc 对二进制位操作</p>
</blockquote>
<pre><code>    ;BT 把 10000001b 的第七位复制到 CF, 得知是 1
    mov dx, 10000001b
    bt  dx, 7
    lahf
    ;47 - 01000111b (CF=1)
    ;BT 把 10000001b 的第六位复制到 CF, 得知是 0
    bt  dx, 6
    lahf
    ;86 - 10000110b (CF=0)
    ;BTS 在执行 BT 命令的同时, 把操作数的指定位置为 1
    mov dx, 10000001b
    bts dx, 6
    ;C1 - 11000001b
    ;BTR 在执行 BT 命令的同时, 把操作数的指定位置为 0
    mov dx, 10000001b
    btr dx, 7
    ;01 - 00000001b
    ;BTC 在执行 BT 命令的同时, 把操作数的指定位取反
    mov dx, 10000001b
    btc dx, 0
    ;80 - 10000000b
    btc dx, 0
    ;81 - 10000001b
</code></pre>
<blockquote>
<p>cmp,test 等条件判断</p>
</blockquote>
<pre><code>assume cs:code
code segment
    start:
        mov ax,1
        sub ax,1
        jz test1 ;zf=0 跳转
        ;...
    test1:
        mov ax,1
        cmp ax,ax ;相减只改zf位 结果丢弃
        jz test2 ;zf=0 跳转
        ;...
    test2:
        mov ax,1
        mov dx,2
        test ax,dx ;并运算为0 改zf位为0
        jz test3
        ;...
    test3:
        mov ax,0
        mov bx,0
        ;...
code ends
end start
</code></pre>
<blockquote>
<p>条件方式</p>
</blockquote>
<p><img src=".gitbook/assets/TIM%E6%88%AA%E5%9B%BE20190103164612.jpg" alt="跳转" /></p>
<blockquote>
<p>直接定制表</p>
</blockquote>
<pre><code>assume cs:CODES
;直接定制表示例
data segment ;段名 = 段地址
mydata db 16 dup(1)
mydata1 db 16 dup(0)
myoff dw offset mydata ;2个字节 存储 mydata 偏移地址 内存值: 00 00
myoff1 dw offset mydata1 ;2个字节 存储 mydata1 偏移地址 内存值:10 00
mylen dw offset mydata1 - offset mydata ;2个字节 存储 mydata 长度  内存值:10 00
mylen1 dw offset myoff - offset mydata1 ;2个字节 存储 mydata1 长度 内存值:10 00
myseg dw seg mydata ;2个字节 存储值等于 data 段地址
myseg1 dw seg mydata1 ;2个字节 存储值等于 data 段地址 可得出 seg 段内都是一样的
data ends
;代码段
CODES SEGMENT
ap db 1,2,3 ;ap 为直接定址表 非地址 ap[] 方式访问对应内存
ao: db 1,2,3 ;ao: 为标号 等于地址
START:
    mov ax,data ; 段名=段地址
    mov ds,ax
    mov es,ax
    mov di,0
    mov si,0
    ;段内部定制表,非本段内地址表 加段地址访问 如 ds:mydata[di]
    mov al,ap[di] ;得到第一个元素,赋值到al ap[di] 是cs:ap[di] 简写 AL 01
    ;段外部定制表访问
    mov ax,ds:mylen[0] ;//ax 0010
    ;通过直接定址表循环拷贝示例
    mov cx,16
    repdata:
    mov dl,ds:mydata[di] ; ds 为段地址 mydata 为段内段偏移 di 为偏移
    mov es:mydata1[si],dl
    inc si
    inc di
    loop repdata
CODES ENDS
    END START
</code></pre>
<blockquote>
<p>loop 循环指令</p>
</blockquote>
<pre><code>assume cs:code
code segment
    start:
        mov cx,3
        mov dx,1
        mov ax,0
    looptest:
        add ax,dx
        loop looptest
    ;ax=3
code ends
end start
</code></pre>
<blockquote>
<p>push pop栈指令</p>
</blockquote>
<pre><code>assume cs:code
data segment
    dw 8 dup(0)
data ends;
stack segment stack ;栈字段加这个关键字 指定为程序所用栈内存,去除编译警告.
    dw 8 dup(0);CPU的一些数据会写入栈顶后大约10个字节数据(CS IP 等),所以申请栈时候最好多16字节
stack ends;;
code segment
    start:
        mov ax,0
        mov bx,1
        test ax,bx
        jz tmp
        mov bx,data
        mov ds,bx
        mov bx,stack
        mov ss,bx
        mov ax,16
        mov sp,ax
        mov cx,8
    pushdata:
        mov ax,1122h
        push ax
        loop pushdata
        mov di,0
        mov cx,8
    popdata:
        pop dx
        mov ds:[di],dx
        add di,2
        loop popdata
        jmp tmp
    tmp:
        mov ax,2;
code ends
end start
</code></pre>
<blockquote>
<p>浮点数相关指令:</p>
</blockquote>
<p>浮点数基础:</p>
<pre><code>十进制: 221.001111
32位数: 0x435d0049 二进制文件实际存放为小端:49005d43 可通过objdump查看
    0 10000110 10111010000000001001001
63位数: 0x19ef954f 0x406ba009 (X86小端,高位在后)
    00011001111011111001010101001111 01000000011010111010000000001001
    实际数据:
    0 10000000110 1011101000000000100100011001111011111001010101001111

32位浮点:
    0 1位 符号位 
    10000110 8位 偏移位-127 所以:134-127=7
    10111010000000001001001 23位 尾数据 前面加 1. 参见下面:
    1.10111010000000001001001  实际数据:向右移动7位
    =221.00111389160156

64位浮点:
    0 1位 符号位 
    10000000110 11位 偏移位-1023 所以:1030-1023 =7 
    1011101000000000100100011001111011111001010101001111 尾数据 前面加 1. 参见下面:
    1.1011101.000000000100100011001111011111001010101001111  实际数据:向右移动7位
    =221.001111
</code></pre>
<p>st0-st8 80位浮点寄存器 xmm0-xmm15 128位浮点数寄存器 (32bit xmm0-xmm7) ymm0-ymm16 256位浮点数寄存器</p>
<blockquote>
<p>浮点数在AT&amp;T时,保存在 .rodata 端 通过偏移rip获得,跟整数不同 整数位$11这样的立即数 浮点寄存器在X86的64位机器默认使用xmm0-xmm15寄存器,且float 和double 都一样</p>
</blockquote>
<pre><code>float a=221.001111;
//汇编代码:
//movss  0xa5(%rip),%xmm0
//movss  %xmm0,-0x1c(%rbp)
double b=221.001111;
//汇编代码:
//movsd  0xa0(%rip),%xmm0
//movsd  %xmm0,-0x8(%rbp)
double n=a
//汇编代码:
cvtss2sd -0x1c(%rbp),%xmm1 ;精度提升并赋值到寄存器 精度下降指令为: cvtsd2ss
movsd  %xmm1,-0x10(%rbp)
</code></pre>
<blockquote>
<p>addsd 双精度加指令,规则:add sd 双精度 ss 单精度 其他指令类似</p>
<pre><code>cvtss2sd -0x14(%rbp),%xmm0
movsd  %xmm0,-0x8(%rbp)
</code></pre>
</blockquote>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../cpp/hui-bian-ji-cun-qi.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../cpp/jin-cheng-du-xie-wen-jian-suo.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../cpp/hui-bian-ji-cun-qi.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../cpp/jin-cheng-du-xie-wen-jian-suo.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../ace.js" type="text/javascript" charset="utf-8"></script>
        <script src="../editor.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mode-rust.js" type="text/javascript" charset="utf-8"></script>
        <script src="../theme-dawn.js" type="text/javascript" charset="utf-8"></script>
        <script src="../theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
